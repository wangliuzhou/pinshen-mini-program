"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var webAPI = require("../../api/app/AppService");
var FeedSurveyPage = (function () {
    function FeedSurveyPage() {
        this.data = {
            quesTitle: "",
            surveyId: 0,
            isAnswerPositive: true,
        };
    }
    FeedSurveyPage.prototype.onLoad = function (option) {
        var surveyId = Number(option.surveyId);
        this.setData({
            surveyId: surveyId
        });
        var req = { survey_id: surveyId };
        var that = this;
        webAPI.RetrieveSurvey(req).then(function (resp) {
            var quesTitle = resp.question;
            that.setData({
                quesTitle: quesTitle,
                showQuesDlg: true
            });
        }).catch(function (err) { console.log(err); });
    };
    FeedSurveyPage.prototype.onQuesDlgBtnPress = function (event) {
        var flag = event.currentTarget.dataset.selection;
        this.setData({
            isAnswerPositive: flag
        });
    };
    FeedSurveyPage.prototype.onQuesDlgBtnSubmit = function () {
        var surveyId = this.data.surveyId;
        if (surveyId === 0) {
            return;
        }
        var req = { survey_id: surveyId, is_positive: this.data.isAnswerPositive };
        webAPI.CreateSurveyAnswer(req).then(function (resp) {
            console.log(resp);
            wx.navigateBack({ delta: 1 });
        }).catch(function (err) { return wx.showModal({ title: "", content: "上传用户回答失败", showCancel: false }); });
    };
    return FeedSurveyPage;
}());
Page(new FeedSurveyPage());
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLGlEQUFtRDtBQUduRDtJQUFBO1FBQ1MsU0FBSSxHQUFHO1lBQ1osU0FBUyxFQUFFLEVBQUU7WUFDYixRQUFRLEVBQUUsQ0FBQztZQUNYLGdCQUFnQixFQUFFLElBQUk7U0FDdkIsQ0FBQTtJQXNDSCxDQUFDO0lBcENRLCtCQUFNLEdBQWIsVUFBYyxNQUFVO1FBQ3RCLElBQUksUUFBUSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdEMsSUFBWSxDQUFDLE9BQU8sQ0FBQztZQUNwQixRQUFRLEVBQUUsUUFBUTtTQUNuQixDQUFDLENBQUM7UUFDSCxJQUFJLEdBQUcsR0FBRyxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsQ0FBQztRQUNsQyxJQUFJLElBQUksR0FBRyxJQUFJLENBQUM7UUFDaEIsTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxJQUFJO1lBQ2xDLElBQUksU0FBUyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7WUFDN0IsSUFBWSxDQUFDLE9BQU8sQ0FBQztnQkFDcEIsU0FBUyxFQUFFLFNBQVM7Z0JBQ3BCLFdBQVcsRUFBRSxJQUFJO2FBQ2xCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFBLEdBQUcsSUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekMsQ0FBQztJQUVNLDBDQUFpQixHQUF4QixVQUF5QixLQUFTO1FBQ2hDLElBQUksSUFBSSxHQUFHLEtBQUssQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQztRQUNoRCxJQUFZLENBQUMsT0FBTyxDQUFDO1lBQ3BCLGdCQUFnQixFQUFFLElBQUk7U0FDdkIsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUVNLDJDQUFrQixHQUF6QjtRQUVFLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDO1FBQ2xDLElBQUksUUFBUSxLQUFLLENBQUMsRUFBRTtZQUNsQixPQUFPO1NBQ1I7UUFDRCxJQUFJLEdBQUcsR0FBRyxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUMzRSxNQUFNLENBQUMsa0JBQWtCLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUEsSUFBSTtZQUV0QyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xCLEVBQUUsQ0FBQyxZQUFZLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNoQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBQSxHQUFHLElBQUksT0FBQSxFQUFFLENBQUMsU0FBUyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFuRSxDQUFtRSxDQUFDLENBQUM7SUFDdkYsQ0FBQztJQUNILHFCQUFDO0FBQUQsQ0FBQyxBQTNDRCxJQTJDQztBQUVELElBQUksQ0FBQyxJQUFJLGNBQWMsRUFBRSxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyB3ZWJBUEkgZnJvbSAnLi4vLi4vYXBpL2FwcC9BcHBTZXJ2aWNlJztcbmltcG9ydCAqIGFzIGdsb2JhbEVudW0gZnJvbSAnLi4vLi4vYXBpL0dsb2JhbEVudW0nO1xuXG5jbGFzcyBGZWVkU3VydmV5UGFnZSB7XG4gIHB1YmxpYyBkYXRhID0ge1xuICAgIHF1ZXNUaXRsZTogXCJcIixcbiAgICBzdXJ2ZXlJZDogMCxcbiAgICBpc0Fuc3dlclBvc2l0aXZlOiB0cnVlLFxuICB9XG5cbiAgcHVibGljIG9uTG9hZChvcHRpb246YW55KSB7XG4gICAgbGV0IHN1cnZleUlkID0gTnVtYmVyKG9wdGlvbi5zdXJ2ZXlJZCk7XG4gICAgKHRoaXMgYXMgYW55KS5zZXREYXRhKHtcbiAgICAgIHN1cnZleUlkOiBzdXJ2ZXlJZFxuICAgIH0pO1xuICAgIGxldCByZXEgPSB7IHN1cnZleV9pZDogc3VydmV5SWQgfTtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgd2ViQVBJLlJldHJpZXZlU3VydmV5KHJlcSkudGhlbihyZXNwID0+IHtcbiAgICAgIGxldCBxdWVzVGl0bGUgPSByZXNwLnF1ZXN0aW9uO1xuICAgICAgKHRoYXQgYXMgYW55KS5zZXREYXRhKHtcbiAgICAgICAgcXVlc1RpdGxlOiBxdWVzVGl0bGUsXG4gICAgICAgIHNob3dRdWVzRGxnOiB0cnVlXG4gICAgICB9KTtcbiAgICB9KS5jYXRjaChlcnIgPT4geyBjb25zb2xlLmxvZyhlcnIpOyB9KTtcbiAgfVxuXG4gIHB1YmxpYyBvblF1ZXNEbGdCdG5QcmVzcyhldmVudDphbnkpe1xuICAgIGxldCBmbGFnID0gZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0LnNlbGVjdGlvbjtcbiAgICAodGhpcyBhcyBhbnkpLnNldERhdGEoe1xuICAgICAgaXNBbnN3ZXJQb3NpdGl2ZTogZmxhZ1xuICAgIH0pXG4gIH1cblxuICBwdWJsaWMgb25RdWVzRGxnQnRuU3VibWl0KCkge1xuICAgIC8vc3VibWl0IGlzQW5zd2VyUG9zaXRpdmUgdG8gYmFja2VuZFxuICAgIGxldCBzdXJ2ZXlJZCA9IHRoaXMuZGF0YS5zdXJ2ZXlJZDtcbiAgICBpZiAoc3VydmV5SWQgPT09IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IHJlcSA9IHsgc3VydmV5X2lkOiBzdXJ2ZXlJZCwgaXNfcG9zaXRpdmU6IHRoaXMuZGF0YS5pc0Fuc3dlclBvc2l0aXZlIH07XG4gICAgd2ViQVBJLkNyZWF0ZVN1cnZleUFuc3dlcihyZXEpLnRoZW4ocmVzcCA9PiB7XG4gICAgICAvL2Rpc21pc3MgdGhlIGRpYWxvZyB0aGVuIHNldCBzdXJ2ZXkgaWQgdG8gMFxuICAgICAgY29uc29sZS5sb2cocmVzcCk7XG4gICAgICB3eC5uYXZpZ2F0ZUJhY2soeyBkZWx0YTogMSB9KTtcbiAgICB9KS5jYXRjaChlcnIgPT4gd3guc2hvd01vZGFsKHsgdGl0bGU6IFwiXCIsIGNvbnRlbnQ6IFwi5LiK5Lyg55So5oi35Zue562U5aSx6LSlXCIsIHNob3dDYW5jZWw6IGZhbHNlIH0pKTtcbiAgfVxufVxuXG5QYWdlKG5ldyBGZWVkU3VydmV5UGFnZSgpKSJdfQ==